# 2703ICT Assignment 1 Details

1. [x] All pages must have a navigation menu, either across the top of the page or down the left or right column.
2. [x] The home page must display all posts. Only posts should be displayed, not comments.
3. [x] Next to each post there should a number indicating how many comments are there for this post.
    - [x] `SELECT COUNT(*) as numComments WHERE fk_post_id = posts.id`
4. [x] From the home page, click on a post will bring up the comments page. The comments page for a post should contain that post and all comments for that post.
    - [x] Select post title to open or comments icon
    - [x] Cover no comments @empty
5. [x] The home page must _display a form for the user to create a new post_. Each post should contain a _title, a message, a date, an icon, and a user’s name_ (the user is not required to login, they can simply enter their name in the post form). All posts can have the same icon. When creating a new post, _user must enter the title, message, and user’s name_. Date can either be entered or generated by the system. After a new post is successfully created, it should _redirect back to the home page_.
    - [x] Avatar is optional field. Enter image url or set default if null
    - [x] Min characters (set as db values)
    - [x] htmlspecialchars()
    - [x] Intentionally did not put 'required' on inputs to demonstrate validation
6. [x] Users can edit posts. After a post is edited, the comments page for that post is displayed.
7. Users can delete posts. When user deletes a post, the comments for that post should also be deleted.
    - [x] Get the last `DB::getPdo()->lastInsertId();`
    - [x] `redirect('/post/$lastId)`
    - [x] delete posts where id = id, delete comments where fk_post_id = id
8. [x] Users can add comments to a post. A comment must have a _message and a user_, but _no title_.
9. [x] Users can delete comments.
10. [x] There is a page that lists all unique users that have made a post (i.e. a user is only displayed once no matter how many posts this user has made). Clicking on the user should display all posts made by that user.
    - [x] click on username to display posts
    - [x] click on users to show unique users
11. [x] There is a most recent page, which shows only the posts that have been made in the last 7 days.
    - [x] seven days inclusive of the current day. for example Monday - Sunday with Sunday being the 7th day.

## Technical requirements

1. [x] This assignment must be implemented using Laravel. Database access should be implemented via raw SQL and executed through Laravel’s DB class. You are not to use Laravel's ORM (ORM will be used for assignment 2).
2. [x] An SQL file should be used to create tables and insert initial data. There should be enough initial data to thoroughly test the retrieval, update, and deletion functionalities you have implemented.
3. [x] All input must be validated; validation errors message must be displayed within the view.
4. [x] Proper security measures must be implemented, e.g. perform HTML and SQL sanitisation etc. You should be able to explain the security measures you have implemented.
5. [x] Template inheritance must be properly used.
6. [x] Good coding practice is expected. This includes:

2703ICT Assignment 1 Rubric Tasks

-   [x] Submission
-   [x] Entity Relationship Diagram
-   [x] Documentation
-   [x] Database implementation
-   [x] UI Design
-   [x] List (Posts)
-   [x] Details (comments page)
-   [x] Create Post
-   [x] Edit Post
-   [x] Display number of comments
-   [x] Deletes post
-   [x] Add comment
-   [x] Delete comment
-   [x] Display: unique users/posts by a user
-   [x] Most recent posts
-   [x] Security
-   [x] HTML sanitisation
-   [x] Template Inheritance
-   [x] Code structure and layout
-   [x] Code commenting and naming

## Summary

All tasks where completed as specified in the assignment specifications and rubric.

Rather than writing all the logic in the route file I opted to use stick with the MVC structure and create my own models and controller.

Error handling proved to be a little more challenging than expected

## Priority Tasks

-   [x] sum comments for each post and display home page
-   [ ] Add asterixis for mandatory fields
-   [ ] New post validation title, name and message
-   [ ] Fix post edit page. Add cancel option

## Additional Features

-   [x] Default image if null
-   [x] make form on home page form sticky
-   [ ] Alert for successful actions
-   [ ] Edit post in modal
-   [ ] for each error reusable function???
-   [ ] Pagination

## Questions and Challenges

When attempting to use the SQL `COUNT()` function in the `DB` class the results did not return as expected. After some research I discovered this is because the `DB` class will always return an array of results. The work around is to use the PHP `count(array)` function.

```php
$results = 'SELECT COUNT(comment) FROM comments WHERE fk_comment_id = $id';

return count($results);
```

**Note To Self!** DO NOT put the \$ sign in when adding parameters in routes `{id}` NOT `{$id}`
